{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://udayraj123.github.io/omrchecker/src/defaults/schema.json",
  "title": "Template Validation Schema",
  "description": "OMRChecker input image schema",
  "type": "object",
  "properties": {
    "dimensions": {
      "description": "The dimensions to which each input image will be resized to before processing",
      "type": "array",
      "items": {
        "type": "integer"
      },
      "minItems": 2,
      "maxItems": 2
    },
    "bubbleDimensions": {
      "description": "The dimensions of the overlay bubble area",
      "type": "array",
      "items": {
        "type": "integer"
      },
      "minItems": 2,
      "maxItems": 2
    },
    "preProcessors": {
      "description": "Custom configuration values to use in the template's directory",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
        "name": {
          "enum": ["CropOnMarkers","CropPage","FeatureBasedAlignment","ReadBarcode","GaussianBlur","Levels","MedianBlur"],
          "type": "string"
        },
        "options": {
          "type": "object"
        }
      },
        "allOf": [
          {
            "if": {
              "properties": {
                "name": {
                  "const": "CropOnMarkers"
                }
              }
            },
            "then": {
              "properties": {
                "options": {
                  "type": "object",
                  "propertyNames": {
                  "enum": ["relativePath","min_matching_threshold","max_matching_variation","marker_rescale_range",
                    "marker_rescale_steps","apply_erode_subtract","sheetToMarkerWidthRatio"]
                  },
                  "properties": {
                    "relativePath": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "relativePath"
                  ]
                }
              }
            }
          },
          {
             "if": {
               "properties": {
                 "name": {
                   "const": "FeatureBasedAlignment"
                 }
               }
             },
             "then": {
               "properties": {
                 "options": {
                   "type": "object",
                   "propertyNames": {
                  "enum": ["reference","maxFeatures","goodMatchPercent","2d"]
                   },
                   "properties": {
                     "reference": {
                       "type": "string"
                     }
                   },
                   "required": [
                     "reference"
                   ]
                 }
               }
             }
          },
          {
            "if": {
              "properties": {
                "name": {
                  "const": "Levels"
                }
              }
            },
            "then": {
              "properties": {
                "options": {
                  "type": "object",
                  "propertyNames": {
                    "enum": [
                      "low",
                      "high",
                      "gamma"
                    ]
                  }
                }
              }
            }
          },
          {
            "if": {
              "properties": {
                "name": {
                  "const": "MedianBlur"
                }
              }
            },
            "then": {
              "properties": {
                "options": {
                  "type": "object",
                  "propertyNames": {
                    "enum": [
                      "kSize"
                    ]
                  }
                }
              }
            }
          },
          {
            "if": {
              "properties": {
                "name": {
                  "const": "GaussianBlur"
                }
              }
            },
            "then": {
              "properties": {
                "options": {
                  "type": "object",
                  "propertyNames": {
                    "enum": [
                      "kSize",
                      "sigmax"
                    ]
                  }
                }
              }
            }
          },
          {
             "if": {
               "properties": {
                 "name": {
                   "const": "CropPage"
                 }
               }
             },
             "then": {
               "properties": {
                 "options": {
                   "type": "object",
                   "propertyNames": {
                  "enum": ["morphKernel"]
                   }
                 }
               }
             }
          }
          ],
        "required": [
          "name",
          "options"
        ]
    }
         },
    "concatenations": {
      "description": "The Concatenations parameter is a way to tell OMRChecker which fields need to be joined together before outputting into the csv"
    },
    "singles": {
      "description": "The remaining fields(in order) whose readings shall be forwarded directly in the output csv",
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "emptyVal": {
      "description": "The value to be used in case of empty bubble detected at global level.",
      "type": "string"
    }
  },
  "required": [
    "dimensions",
    "bubbleDimensions",
    "concatenations",
    "singles",
    "preProcessors"
  ]
}
